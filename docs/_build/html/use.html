

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using FlyingKoala &mdash; FlyingKoala 0.0.5b0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api.html" />
    <link rel="prev" title="Install the library" href="installation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> FlyingKoala
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Install the library</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html#install-the-add-in">Install the add-in</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using FlyingKoala</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-flyingkoala-add-in">1. The FlyingKoala Add-In</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#excel-file-name">Excel file name</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ignore-sheets">Ignore Sheets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#reload-koala">Reload Koala</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clear-model-cache">Clear Model Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-cached-model-names">Get Cached Model Names</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-workbook-names">Get workbook Names</a></li>
<li class="toctree-l3"><a class="reference internal" href="#import-functions">Import Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-flyingkoala-configuration">2. The FlyingKoala Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Excel file name</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Ignore Sheets</a></li>
<li class="toctree-l3"><a class="reference internal" href="#auto-load-koala">Auto load Koala</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-flyingkoala-user-defined-functions">3. Using the FlyingKoala User Defined Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-the-flyingkoala-vba-macros">4. Using the FlyingKoala VBA macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="#freestyling-with-flyingkoala">5. Freestyling with FlyingKoala</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="worked_example_horticulture.html">Worked Example - Horticulture</a></li>
<li class="toctree-l1"><a class="reference internal" href="worked_example_timeseries.html">Worked Example - Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="worked_example_bom.html">Worked Example - BoM (Bureau of Meteorology)</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">FlyingKoala</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Using FlyingKoala</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/use.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-flyingkoala">
<span id="use"></span><h1>Using FlyingKoala<a class="headerlink" href="#using-flyingkoala" title="Permalink to this headline">¶</a></h1>
<p>This guide assumes you have FlyingKoala, the FlyingKoala add-in and xlwings already installed. If that’s not the case, head over to <a class="reference internal" href="installation.html#installation"><span class="std std-ref">Install the library</span></a>.</p>
<div class="section" id="the-flyingkoala-add-in">
<h2>1. The FlyingKoala Add-In<a class="headerlink" href="#the-flyingkoala-add-in" title="Permalink to this headline">¶</a></h2>
<p>The FlyingKoala Add-In assists users to manage the cache which holds “models” (/equation systems). This is what it looks like.</p>
<img alt="Add-in menu" src="_images/addin.png" />
<div class="section" id="excel-file-name">
<h3>Excel file name<a class="headerlink" href="#excel-file-name" title="Permalink to this headline">¶</a></h3>
<p>This is the name of the workbook file. This setting is expected to auto-fill.</p>
<p>In the future we expect to be able to load models from other Excel files which is why this configuration is here.</p>
<a class="reference internal image-reference" href="_images/addin_excel_file_name.png"><img alt="Add-in menu excel file name" src="_images/addin_excel_file_name.png" style="width: 400px;" /></a>
</div>
<div class="section" id="ignore-sheets">
<h3>Ignore Sheets<a class="headerlink" href="#ignore-sheets" title="Permalink to this headline">¶</a></h3>
<p>These are worksheets you would like to not load into the koala cache. Most likely used for worksheets which have your raw data, or worksheets which are not currently being used in the modelling you’re working on.</p>
<a class="reference internal image-reference" href="_images/addin_ignore_sheets.png"><img alt="Add-in menu ignore sheets" src="_images/addin_ignore_sheets.png" style="width: 400px;" /></a>
</div>
<div class="section" id="reload-koala">
<h3>Reload Koala<a class="headerlink" href="#reload-koala" title="Permalink to this headline">¶</a></h3>
<p>FlyingKoala caches parts of a specified spreadsheet (eg; the one named in “Excel config name”). To extract the part you are interested in, first Koala needs to have a look at the spreadsheet you are interested in. This button does that initial loading. If the spreadsheet has been loaded, this button will load it again. Great for when a formula in the spreadsheet has changed.</p>
<a class="reference internal image-reference" href="_images/addin_reload_koala.png"><img alt="Add-in button to load the specified spreadsheet." src="_images/addin_reload_koala.png" style="width: 75px;" /></a>
</div>
<div class="section" id="clear-model-cache">
<h3>Clear Model Cache<a class="headerlink" href="#clear-model-cache" title="Permalink to this headline">¶</a></h3>
<p>This button clears the FlyingKoala cache of all the loaded models. Handy if you want to re-load some of the equations.</p>
<a class="reference internal image-reference" href="_images/addin_clear_model_cache.png"><img alt="Add-in button to load the specified spreadsheet." src="_images/addin_clear_model_cache.png" style="width: 75px;" /></a>
</div>
<div class="section" id="get-cached-model-names">
<h3>Get Cached Model Names<a class="headerlink" href="#get-cached-model-names" title="Permalink to this headline">¶</a></h3>
<p>A message box will appear naming all the models which have been loaded into the FlyingKoala model cache.</p>
<a class="reference internal image-reference" href="_images/addin_get_cached_model_names.png"><img alt="Add-in button to display the names of the models which are currently in the FlyingKoala cache." src="_images/addin_get_cached_model_names.png" style="width: 75px;" /></a>
</div>
<div class="section" id="get-workbook-names">
<h3>Get workbook Names<a class="headerlink" href="#get-workbook-names" title="Permalink to this headline">¶</a></h3>
<p>A message box will appear naming all the named ranges xlwings has access to in the loaded workbook. This helps you check spelling on some of the named ranges. This list can also be seen, and managed, in the Formulas ==&gt; Name Manager menu of Excel.</p>
<a class="reference internal image-reference" href="_images/addin_get_workbook_names.png"><img alt="Add-in button to display the named ranges available to xlwings." src="_images/addin_get_workbook_names.png" style="width: 75px;" /></a>
</div>
<div class="section" id="import-functions">
<h3>Import Functions<a class="headerlink" href="#import-functions" title="Permalink to this headline">¶</a></h3>
<p>This is an convenience button. It calls the xlwings UDF Import Functions method. It saves having to move between Add-Ins while developing UDFs.</p>
<a class="reference internal image-reference" href="_images/addin_import_functions.png"><img alt="Add-in button to call the xlwings Import Fucntions methods." src="_images/addin_import_functions.png" style="width: 75px;" /></a>
</div>
</div>
<div class="section" id="the-flyingkoala-configuration">
<h2>2. The FlyingKoala Configuration<a class="headerlink" href="#the-flyingkoala-configuration" title="Permalink to this headline">¶</a></h2>
<p>The FlyingKoala configuration worksheet assists users to manage the relationship between koala and xlwings. It must be named FlyingKoala.conf and this is what it looks like.</p>
<img alt="Add-in menu and configuration worksheet" src="_images/conf.png" />
<p>Currently the config management uses fixed cell references, so don’t move anything. (<strong>TODO: open for contribution. There’s an example in xlwings for inspiration.</strong>)</p>
<p>This is not kept in an external file as the FlyingKoala operations are generally workbook specific. You are likely to want to have this workbook behave in a particular way – especially when someone opens the file and re-calc while they are using it.</p>
<div class="section" id="id1">
<h3>Excel file name<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>This is the name of the workbook file. This setting is expected to auto-fill, but will also be over-written by whatever gets put in the corresponding field in the Add-In.</p>
</div>
<div class="section" id="id2">
<h3>Ignore Sheets<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>These are a comma delimited list of worksheets you want to have Koala ignore when it loads your spreadsheet into cache. If there is a space in the worksheet name you’ll need to use double quotes.</p>
</div>
<div class="section" id="auto-load-koala">
<h3>Auto load Koala<a class="headerlink" href="#auto-load-koala" title="Permalink to this headline">¶</a></h3>
<p>This will allow or deny xlwings the ability to load the workbook when you load UDFs. Basically, it’s telling xlwings that when the Python interpreter service starts it’s allowed to initialise Koala or not.</p>
<ul class="simple">
<li><p>TRUE: the spreadsheet will be loaded into Koala when xlwings interpreter service starts.</p></li>
<li><p>FALSE: The spreadsheet will _not_ be loaded into Koala when xlwings interpreter service starts.</p></li>
</ul>
</div>
</div>
<div class="section" id="using-the-flyingkoala-user-defined-functions">
<h2>3. Using the FlyingKoala User Defined Functions<a class="headerlink" href="#using-the-flyingkoala-user-defined-functions" title="Permalink to this headline">¶</a></h2>
<p>Providing the User Defined Functions (UDFs) you are expecting to use already exist in the FlyingKoala library you can simply import them. They won’t be loaded at this point, but will become available for use in Excel like any other formula. An equation will become loaded into Koala cache as a model when you use it.</p>
<p>Make sure you have the dependencies installed for the FlyingKoala module you want to use. Notes on this can be found in <a class="reference internal" href="installation.html#installation"><span class="std std-ref">Install the library</span></a>.</p>
<p>For calculating Growing Degree-Days you would have a module that would look like this:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlwings</span> <span class="k">as</span> <span class="nn">xw</span>
<span class="kn">from</span> <span class="nn">flyingkoala</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">flyingkoala.horticulture</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>For doing some time series transformation you would have a module that would look like this:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlwings</span> <span class="k">as</span> <span class="nn">xw</span>
<span class="kn">from</span> <span class="nn">flyingkoala</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">flyingkoala.timeseries</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<p>For doing some time series transformation while calculating Growing Degrees-Day you would have a module that would look like this:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlwings</span> <span class="k">as</span> <span class="nn">xw</span>
<span class="kn">from</span> <span class="nn">flyingkoala</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">flyingkoala.horticulture</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">flyingkoala.timeseries</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="section" id="using-the-flyingkoala-vba-macros">
<h2>4. Using the FlyingKoala VBA macros<a class="headerlink" href="#using-the-flyingkoala-vba-macros" title="Permalink to this headline">¶</a></h2>
<p>Providing the macro functions you are expecting to use already exist in the FlyingKoala library they will be installed with FlyingKoala.</p>
<p>You’ll want to be familiar with writing VBA and reading API style documentation for this one.</p>
<p>Once everything is installed correctly you can call the FlyingKoala VBA functions as you normally do with VBA.</p>
</div>
<div class="section" id="freestyling-with-flyingkoala">
<h2>5. Freestyling with FlyingKoala<a class="headerlink" href="#freestyling-with-flyingkoala" title="Permalink to this headline">¶</a></h2>
<p>If the functionality you want isn’t yet supported in a FlyingKoala module, you’ll need to write your own (and maybe put it forward to be included in FlyingKoala :D).</p>
<p>This is the advanced approach. It has a rather steep curve. Once you ‘get it’ things aren’t terrible, but I do admit there are a lot of moving parts. The worked example in the example document Introduction_Article.PDF is a great resource.</p>
<p>From here on you’ll want to be an particularly familiar with;</p>
<ul class="simple">
<li><p>writing Python</p></li>
<li><p>writing xlwings UDFs</p></li>
<li><p>using Excel named ranges, named cells and Excel’s Manage Ranges feature</p></li>
</ul>
<p>Strap in… Here we go!</p>
<p>At the very core FlyingKoala offers an xlwings friendly interface to Koala2.</p>
<p>Koala2 is a project which can read an MS Excel equation, convert it into Python and then evaluate (run) the Python to produce a result for the equation. FlyingKoala caches the Python code generated for each MS Excel equation and so we can change out the definition of an equation on each call to a function.</p>
<p>To take advantage of the FlyingKoala interface to Koala2 we need to write a function which takes at least two types of argument:</p>
<ul class="simple">
<li><p>named range name</p></li>
<li><p>terms for an equation</p></li>
</ul>
<p>The named range name is simply a string which identifies the name of a named range containing an equation you want interpreted into Python. This is what the equation will have been keyed on in the cache.</p>
<p>Terms for an equation are variables which will be used while evaluating an equation.</p>
<p>Let us work through writing a Python function taking advantage of FlyingKoala’s interface with Koala2 using Growing Degrees Day as the example.</p>
<p>Growing Degrees Day calculations are often specific to a particular application. Potentially differing on region, variety of plants or a number of other influences. When we look at Wikipedia we can find no less than two different equations.</p>
<div class="math notranslate nohighlight">
\[GDD  = \frac{T_{\textrm{max}} + T_{\textrm{min}}}{2} - T_{\textrm{base}}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[GDD  =  \textrm{max}\left( \frac{T_{\textrm{max}} + T_{\textrm{min}}}{2} - T_{\textrm{base}} \, ,\,0\right)\]</div>
<p>Consider a situation where we want to do some modelling of those two documented examples and, maybe, develop another method to optimize for our specific situation. It would be great to simply write the equations in Excel while we are running scenarios and developing the new one.</p>
<p>We can see in the above that even though the relationship between the terms is quite different, calculating a Growing Degree Day appears to require the same number of inputs, namely T_min, T_max and T_base. The rest of the relationship is in operators and hard constants. This is an observation which often holds up while developing equations… You only have, or need, particular inputs to find the answer to something and if there is another pathway to the answer it is likely to still only need the same inputs (often enough they are the only inputs you <em>can get</em>).</p>
<p>The truly variable terms in the Growing Degree Day equations are T_min and T_max. To obviate some Wikipedia reading, T_base is usually set to a value of 10. This makes T_base a soft constant. One you <em>might</em> change but are likely not to. We want to support an ability to change it. Remember, we are trying to invent new mathematics so if there’s a knob - we need to be able to turn it.</p>
<p>With that understanding, we can now write a Python function which takes a key for the cache (a named range name) and two parameters being T_min and T_max:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">flyingkoala</span> <span class="kn">import</span> <span class="n">flyingkoala</span> <span class="k">as</span> <span class="n">fk</span>

<span class="k">def</span> <span class="nf">DegreeDay</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">T_min</span><span class="p">,</span> <span class="n">T_max</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function for calculating Degree Day&quot;&quot;&quot;</span>

    <span class="n">inputs_for_DegreeDay</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;T_min&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T_min</span><span class="p">]),</span> <span class="s1">&#39;T_max&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T_max</span><span class="p">])})</span>
    <span class="k">return</span> <span class="n">fk</span><span class="o">.</span><span class="n">EvaluateKoalaModel</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">inputs_for_DegreeDay</span><span class="p">)</span>
</pre></div>
</div>
<p>This function is not finished. It still needs xlwings mark-up to become a User Defined Function. But we can see here that there is nothing genuinely complex about taking three arguments, packaging two into a Pandas Dataframe and then calling EvaluateKoalaModel.</p>
<p>If we put all the xlwings markup on the above Python function, we can import it as a User Defined Function:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nd">@xw</span><span class="o">.</span><span class="n">func</span>
<span class="nd">@xw</span><span class="o">.</span><span class="n">arg</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">xw</span><span class="o">.</span><span class="n">Range</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Name, as a string, of the model which will be evaluated. The Excel cell name / named range&#39;</span><span class="p">)</span>
<span class="nd">@xw</span><span class="o">.</span><span class="n">arg</span><span class="p">(</span><span class="s1">&#39;T_min&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Daily minimum temperature&#39;</span><span class="p">)</span>
<span class="nd">@xw</span><span class="o">.</span><span class="n">arg</span><span class="p">(</span><span class="s1">&#39;T_max&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="s1">&#39;Daily maximum temperature&#39;</span><span class="p">)</span>
<span class="nd">@xw</span><span class="o">.</span><span class="n">ret</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">DegreeDay</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">T_min</span><span class="p">,</span> <span class="n">T_max</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to assemble a dataframe for calculating Degree Day&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">fk</span><span class="o">.</span><span class="n">isKoalaModelCached</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
        <span class="n">fk</span><span class="o">.</span><span class="n">generateModelGraph</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

    <span class="n">inputs_for_DegreeDay</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;T_min&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T_min</span><span class="p">]),</span> <span class="s1">&#39;T_max&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T_max</span><span class="p">])})</span>
    <span class="k">return</span> <span class="n">fk</span><span class="o">.</span><span class="n">EvaluateKoalaModel</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">inputs_for_DegreeDay</span><span class="p">)</span>
</pre></div>
</div>
<p>This is essentially all a developer or appropriately skilled data analyst needs to do. The rest is up to the domain expert as it is a case of setting Excel up correctly and then defining the mathematical relationship.</p>
<p><strong>NOTE</strong>: The mathematical relationship for the equation is not expressed in Python yet. The definition is the responsibility of the domain expert to define in an Excel formula and Koala2 to manage running that definition in Python.</p>
<p>Although setting Excel up is demonstrated in the worked example in the example document Introduction_Article.PDF I’ll run through it briefly here.</p>
<p>To set Excel up…</p>
<p>Define named cells for each of the terms. The keys in the anonymous dict which is used to create inputs_for_DegreeDay need to be the same as the names of the named ranges (cell names) that will be used in the Excel formula.</p>
<p>To be specific there needs to be an Excel cell named ‘T_min’, another called ‘T_max’. These names need to be global (can be identified in the Manage Names menu of Excel). These cells need to be referenced in the Excel equation - <strong>NOT</strong> the cell address.</p>
<p>Now we can write an MS Excel formula which will define the relationship between T_min, T_max and T_base. This is the Excel formula for the first GDD equation and is in a cell called Equation_1:</p>
<blockquote>
<div><p>=((T_max+T_min)/2)-T_base</p>
</div></blockquote>
<p>NOTE: we have used the cell names, not the cell address eg; T_max <strong>not</strong> GDD_formula!B5</p>
<p>Providing the DegreeDay UDF definition is defined, we can use it in Excel:</p>
<blockquote>
<div><p>=DegreeDay(Equation_1, 3, 25)</p>
</div></blockquote>
<p>That Excel equation will grab the equation from the call called Equation_1 which is =((T_max+T_min)/2)-T_base, convert the equation to Python, set T_min to 3, T_max to 25, T_base to 10, evaluate the result and return it as a value to the cell.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api.html" class="btn btn-neutral float-right" title="API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="installation.html" class="btn btn-neutral float-left" title="Install the library" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Bradley van Ree

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>